YUI.add("screen",function(Y){"use strict";var Screen,_bridge,i,prefix,extensions=["webkit","moz","o","ms","khtml"],CLASSNAME="rmr-screen";if(_bridge={prefix:"",supported:!1,isFullScreen:function(){return!1},exit:function(){},request:function(){},eventName:null},"undefined"!=typeof document.cancelFullScreen)_bridge.supported=!0;else for(i=0;i<extensions.length;i++)if(prefix=extensions[i],"undefined"!=typeof document[prefix+"CancelFullScreen"]){_bridge.supported=!0,_bridge.prefix=prefix;break}_bridge.supported&&(Y.one("body").addClass("rmr-screenable"),_bridge.eventName=_bridge.prefix+"fullscreenchange",_bridge.request=function(node){return prefix?node._node[prefix+"RequestFullScreen"]():node._node.requestFullScreen()},_bridge.exit=function(node){return prefix?document[prefix+"CancelFullScreen"]():document.cancelFullScreen()},_bridge.isFullScreen=function(){var r=null;switch(prefix){case"webkit":r=document.webkitIsFullScreen;break;default:document.hasOwnProperty("fullScreen")?r=document.fullScreen:document.hasOwnProperty("fullscreen")&&(r=document.fullscreen),r=document[prefix+"FullScreen"]}return r}),Screen=function(config){if(Screen.superclass.constructor.apply(this,arguments),!_bridge.supported)return!1;this.set("node",config.hasOwnProperty("node")?config.node:document.body);var $=this;return this.get("node")?(this.set("listener",function(e){$.isFullScreen()?($.fire("fullscreen"),Y.one(e.target).addClass(CLASSNAME)):($.fire("exit"),$.get("node").removeClass(CLASSNAME))}),void this.get("node")._node.addEventListener(_bridge.eventName,this.get("listener"))):null},Screen.ATTRS={node:{setter:function(node){var n=Y.one(node);return n?n:null},writeOnce:!0},listener:{}},Y.Screen=Y.extend(Screen,Y.Base,{isFullScreen:function(){return _bridge.isFullScreen()},isSupported:function(){return _bridge.supported},toggle:function(){return this.isFullScreen()?this.exit():this.request()},request:function(){var n=this.get("node");return n?(_bridge.request(n),this):!1},exit:function(){return _bridge.exit(),this},toString:function(){return"Screen <"+this.get("node")+">"},destructor:function(){this.get("node")&&(this.get("node")._node.removeEventListener(_bridge.eventName,this.get("listener")),this.set("node",null))},NAME:"screen"})},"3.3.1",{requires:["node","event","base"]}),YUI.add("backdrop",function(Y){"use strict";var Backdrop=function(config){return Backdrop.superclass.constructor.apply(this,arguments),this.set("url",config.hasOwnProperty("url")?config.url:null),this.set("id",config.hasOwnProperty("id")?config.id:null),this.set("duration",config.hasOwnProperty("duration")?config.duration:null),this.set("styles",config.hasOwnProperty("styles")?config.styles:null),this.get("url")&&this.drop(),this},DEFAULT_STYLES={color:"transparent",position:"top left",repeat:"no-repeat",attachment:"fixed",size:"auto"};Backdrop.ATTRS={url:{value:null},id:{value:null,setter:function(id){return id||"backdrop"},writeOnce:!0},styles:{value:null},duration:{value:1,setter:function(i){return i?parseFloat(i,10):1}}},Y.Backdrop=Y.extend(Backdrop,Y.Base,{destructor:function(){this.set("id",null),this.set("duration",null),this.set("url",null),this.set("styles",null)},_applyStyles:function(node,styles){for(var s in styles)styles.hasOwnProperty(s)&&node.setStyle("background"+s.charAt(0).toUpperCase()+s.substr(1),styles[s])},drop:function(config){"string"==typeof config?(this.set("url",config),this.set("styles",null)):config&&(config.hasOwnProperty("url")&&this.set("url",config.url),config.hasOwnProperty("duration")&&this.set("duration",config.duration),this.set("styles",config.hasOwnProperty("styles")?config.styles:null));var img=new Image,o={};return o.$=this,o.node=Y.Node.create('<div id="'+this.get("id")+'"></div>'),img.onload=function(){Y.one("body").append(o.node);var s=Y.merge(DEFAULT_STYLES,o.$.get("styles"));o.$.fire("start",this.src),s.image="url("+this.src+")",o.$._applyStyles(o.node,s),o.$.resize(),o.node.transition({opacity:1,duration:o.$.get("duration")},function(){o.$.fire("end",o.$.get("url"));var styles=Y.merge(DEFAULT_STYLES,o.$.get("styles")),body=Y.one("body");styles.image="url("+img.src+")",o.$._applyStyles(body,styles),o.node.remove()}),Y.on("windowresize",function(){o.$.resize()})},img.src=this.get("url"),this},resize:function(){var body=Y.one(document.body),region=null,node=Y.one("#"+this.get("id"));return body.setStyle("minHeight",body.get("winHeight")+"px"),region=body.get("region"),node&&node.setStyles({width:region.width+"px",height:region.height+"px"}),this},toString:function(){return"[Backdrop]"}})},"3.3.1",{requires:["node","base","event","event-resize","transition"]}),YUI().use(function(Y){"use strict";return Y.UA.mobile?!1:void Y.use("backdrop","screen","node-focusmanager",function(Y){var dropper=new Y.Backdrop({id:"backdrop",duration:.5}),styles={backdrop:{size:"cover"},chinatown:{repeat:"repeat-y",size:"cover"},evs:{color:"#fff",position:"bottom right"},kaos:{position:"370px top",color:"#000"},ubc:{position:"right bottom",color:"#000"},bodhisattva:{position:"right bottom",color:"#fff"},stream:{position:"400px top",color:"#fff"},moma:{position:"right top",color:"#000"},lacma:{position:"right center",color:"#000"},getty:{position:"left bottom",color:"#000",size:"cover"},vegas:{color:"#000",position:"right top"},rmr:{color:"#a2a2a2",position:"center center"},koru:{color:"#a2a2a2",position:"center center",size:"cover"},archive:{color:"#fafafa",size:"contain",position:"left bottom"},pink:{size:"cover"}},parser=function(path){return path.replace(/^.*[\/\\]/g,"").split(".")[0]},body=Y.one(document.body),doc=Y.one("#doc"),screen=new Y.Screen({node:body}),input=null,bg=function(n){var cls=parser(n.getAttribute("href"));document.location="#"+cls,doc.hasClass(cls)||dropper.drop({url:n.getAttribute("href"),styles:styles[cls]})},toggle=null,title="Toggle fullscreen",resizer=function(){Y.one("#doc").setStyle("minHeight",Y.one(document.body).get("winHeight")-150+"px")};if(Y.on("windowresize",resizer),resizer(),dropper.on("start",function(e){var bg=parser(e.details[0]),li=Y.one("ol li."+bg);doc.set("className",bg),Y.all("ol li").removeClass("active"),li&&li.addClass("active")}),dropper.on("end",function(e){Y.all("img.pin").remove(),Y.one("body").append('<img src="'+e.details[0]+'" class="pin">')}),Y.on("domready",function(e){var hash=document.location.hash?document.location.hash.replace("#",""):null,first=hash&&styles.hasOwnProperty(hash)?Y.one("ol li."+hash+" a"):Y.one("ol li a")?Y.one("ol li a"):null;first=first?first.getAttribute("href"):window.RMR&&window.RMR.backdrop?window.RMR.backdrop:Y.one("html").getAttribute("data-backdrop"),first&&dropper.drop({url:first,styles:styles[parser(first)]})}),Y.all("ol li a").on("click",function(e){e.halt(),bg(e.target.ancestor("a",!0))}),screen.isSupported()){var section=Y.one("section.zoom");toggle=function(){screen.toggle()},Y.on("key",toggle,body,"f"),section&&(input=Y.Node.create('<button title="'+title+'" class="zoom">'+title+"</button>"),Y.one("section.zoom").append(input),input.on("click",toggle))}Y.all("#doc section section").each(function(n){n.plug(Y.Plugin.NodeFocusManager,{descendants:"a, button",keys:{next:"down:40",previous:"down:38"}})}),Y.one(document.body).on("key",function(e){var code=e.keyCode,li=null;code=48==code?9:code-49,li=Y.all("ol li"),li.size()<=code||bg(li.item(code).one("a"))},"48,49,50,51,52,53,54,55,56,57")})});